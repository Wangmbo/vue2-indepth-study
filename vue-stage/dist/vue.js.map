{"version":3,"file":"vue.js","sources":["../src/utils.js","../src/observer/array.js","../src/observer/index.js","../src/state.js","../src/compiler/parse.js","../src/compiler/generate.js","../src/compiler/index.js","../src/lifecycle.js","../src/init.js","../src/vdom/index.js","../src/render.js","../src/index.js"],"sourcesContent":["export function isFuntion(data) {\n  return typeof data === 'function'\n}\n\nexport function isObject(val) {\n  return typeof val === 'object' && val != null\n}","export let arrayMethods = Object.create(Array.prototype)\n\nlet oldArrayPrototype = Array.prototype\n\nlet methods = ['push', 'shift', 'pop', 'unshift', 'reverse', 'splice', 'sort']\n\nmethods.forEach(method => {\n  arrayMethods[method] = function(...args) {\n    console.log('数组发生变化...')\n    // TODO 如果是push了一个对象之类的，也需要劫持...\n    const result = oldArrayPrototype[method].call(this, ...args)\n    // 如果有新增，我们要监控的是数组的每一项，而不是数组\n    let addList\n    switch (method) {\n      case 'push': \n      case 'unshift':\n        addList = args\n        break;\n      case 'splice':\n        addList = args.concat(2)\n        break;\n      default:\n    }\n    console.log(this.__ob__)\n    this.__ob__.observeArray(addList)\n    console.log(addList, 'addList')\n    return result\n  }\n})","import { isObject } from \"../utils\";\nimport { arrayMethods } from './array'\n\n// 如果数据是对象 会将对象不停地递归 进行劫持\n// 如果是数组， 会劫持数组的方法，并对数组中不是基本数据类型的进行检测\nclass Observe {\n  constructor(data) { // 对对象中的所有属性进行劫持\n    Object.defineProperty(data, '__ob__', {\n      value: this,\n      enumerable: false\n    })\n    // data.__ob__ = this\n    if(Array.isArray(data)) {\n      // 数组劫持的逻辑\n      // 核心思想是对数组的方法进行劫持\n      // 对数组原来的方法进行改写，切片编程 高阶函数\n      data.__proto__ = arrayMethods\n\n      this.observeArray(data)\n    } else {\n      this.walk(data)\n    }\n  }\n  // 循环遍历劫持...\n  walk(data) { // 对象\n    Object.keys(data).forEach((key) => {\n      defineReactive(data, key, data[key])\n    })\n  }\n\n  observeArray(data) {\n    // console.log(data, 'observeArray')\n    data.forEach(item => {\n      observe(item)\n    })\n  }\n}\n\nfunction defineReactive(data, key, value) {\n  observe(value)\n  // TODO Object.defineProperties\n  console.log(data, 'data')\n  Object.defineProperty(data, key, {\n    get() {\n      console.log(key, 'get')\n      return value\n    },\n    set(val) {\n      console.log(key, val, 'set')\n      observe(value)\n      value = val\n    }\n  })\n}\n\n// import { isObject } from '../utils'\nexport function observe(data) {\n  if(data.__ob__) return\n  // 如果是对象才观测\n  if(!isObject(data)) return\n  // if(!isObject(data)) return\n  return new Observe(data)\n}\n// vue2 没有对数组进行索引的劫持\n// 而且一般用户很少通过索引去操作数组.\n// 内部就想到不对索引进行拦截，因为消耗严重.\n// 数组没有监控索引的变化，但是索引对应的内容是对象类型，需要被监控\n\n// 重写了push shift pop unshift reverse sort splice\n// 这几个方法","import { observe } from './observer/index'\nimport { isFuntion } from './utils'\nexport function initState(vm) {\n  const opts = vm.$options\n  if(opts.data) {\n    initData(vm)\n  }\n  if(opts.props) {\n\n  }\n}\n\n\nfunction initData(vm) { // vm\n  let data  = vm.$options.data\n  // 会将data中的所有数据进行数据劫持\n  // defineProperty\n  // 判断类型\n  console.log(data)\n  data = vm._data = isFuntion(data) ? data.call(vm) : data\n\n  for(let key in data) {\n    proxy(vm, '_data', key)\n  }\n  observe(data)\n  // console.log(data)\n}\n\n\nfunction proxy(vm, source, key) {\n  Object.defineProperty(vm, key, {\n    get() {\n      return vm[source][key]\n    },\n    set(newValue) {\n      vm[source][key] = newValue\n    }\n  })\n}\n","const unicodeRegExp = /a-zA-Z\\u00B7\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u203F-\\u2040\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD/\nconst ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z${unicodeRegExp.source}]*` // 标签名\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})` // 用来获取的名的\n// match 后的索引为1的\n\n// Regular Expressions for parsing tags and attributes\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/\n// a=b a=\"b\" a='b'\nconst dynamicArgAttribute = /^\\s*((?:v-[\\w-]+:|@|:|#)\\[[^=]+?\\][^\\s\"'<>\\/=]*)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/\nconst startTagOpen = new RegExp(`^<${qnameCapture}`) // 匹配开始标签\nconst startTagClose = /^\\s*(\\/?)>/ // <div/>\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`) // 匹配闭合标签\nconst doctype = /^<!DOCTYPE [^>]+>/i\nconst defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g\n\n// html字符串解析成dom树 <div id=\"app\"> {{ name }} </div>\n// 将解析后的结果，组装成一个树结构 栈\n// ast 语法层面的描述\n// vdom dom节点\nlet root = null\nlet stack = []\nexport function paeserHTML(html) {\n  function advance(len) {\n    html = html.substring(len)\n  }\n  function parseStartTag() {\n    const start = html.match(startTagOpen)\n    if(start) {\n      const match = {\n        tagName: start[1],\n        attrs: []\n      }\n      advance(start[0].length)\n      // 如果没有遇到皆为标签就不停的解析\n      let end\n      let attr\n      while((!(end = html.match(startTagClose)) && (attr = html.match(attribute)))) {\n        // console.log(attr, 'attr')\n        match.attrs.push({ name: attr[1], value: attr[3] || attr[4] || attr[5] })\n        console.log(attr, '??attr')\n        console.log(html, 'ggg');\n        advance(attr[0].length)\n        console.log(html, '?啦啦啦')\n      }\n      if(end) {\n        console.log(end, 'end')\n        advance(end[0].length)\n        console.log(html, 'end')\n      }\n      return match\n    }\n    return false\n  }\n  function createAstElement(tagName, attrs) {\n    return {\n      tag: tagName,\n      type: 1,\n      children: [],\n      parent: null,\n      attrs\n    }\n  }\n  function start(tagName, attributes) {\n    let parent = stack[stack.length - 1]\n    const element = createAstElement(tagName, attributes)\n    if(!root) {\n      root = element\n    }\n    element.parent = parent // 当放入栈中时，记录父亲是谁\n    if(parent) parent.children.push(element)\n    stack.push(element)\n  }\n  function end(tagName) {\n    // 弹出...\n    let last = stack.pop()\n    console.log(last, tagName, '--------')\n    if(last.tag !== tagName) {\n      throw new Error('标签有误')\n    }\n  }\n  function chars(text) {\n    console.log(text, 'text');\n    console.log(stack, 'stack')\n    text = text.replace(/\\s/g, \"\")\n    const parent = stack[stack.length - 1]\n    // console.log(parent, 'parent')\n    if(text) {\n      parent.children.push({\n        type: 3,\n        text\n      })\n    }\n  }\n  while(html) { // 解析的内容是否存在，如果存在就不停的解析 // htmlParse2\n    let textEnd = html.indexOf('<') // 当前解析的开头\n    if(textEnd === 0) {\n       const startTagMatch = parseStartTag()\n       console.log(startTagMatch, 'startTagMatch')\n       if(startTagMatch) {\n        start(startTagMatch.tagName, startTagMatch.attrs)\n        continue\n       }\n       const endTagMatch = html.match(endTag)\n       console.log(endTagMatch)\n       if(endTagMatch) {\n        end(endTagMatch[1])\n        advance(endTagMatch[0].length)\n        continue\n       }\n    }\n    let text // 1111</div>\n    if(textEnd > 0) {\n      console.log(html, 'html??');\n      text =  html.substring(0, textEnd)\n    }\n    if(text) {\n      chars(text)\n      advance(text.length)\n    }\n  }\n  return root\n}","// TODO 梳理整个思路。。。\n// 看一下用户是否传入了 render \n// 未传入render ，没传入可能传入的是template，如果template也没有传递\n// 将html进行词法解析（开始标签，结束标签 属性 文本）\n// ast 语法树  用来描述html语法的stack = []\n// codegen   <div>hello</div> => _c('div',{},'hello') 让字符串执行\n// eval 耗性能 会有作用域问题\n\n// 模板引擎 new Function\nconst defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g\n\nexport function generate(el) {\n  console.log(el)\n  // 遍历树 将树拼接成字符串\n  let children = genChildren(el)\n  let code = `_c(\"${ el.tag }\",${el.attrs.length ? genProps(el.attrs) : 'undefined'}${ children ? `,${children}`  : '' })`\n\n  return code\n}\n\nfunction gen (el) {\n  if(el.type === 1) return generate(el)\n  // console.log(el, 'el??');\n  if(el.type === 3) {\n    let text = el.text\n    if(!defaultTagRE.test(text)) {\n      return `_v('${text}')`\n    } else {\n      // 'hello' + arr + 'world'\n      let tokens = []\n      let match\n      let lastIndex = defaultTagRE.lastIndex = 0\n      // console.log(text, 'text')\n      // console.log(defaultTagRE.exec(text))\n      while(match = defaultTagRE.exec(text)) {\n        let index = match.index // 开始索引\n        // console.log(index, 'lastIndex')\n        if(index > lastIndex) {\n          console.log(match, 'match')\n          tokens.push(JSON.stringify(text.slice(lastIndex, index)))\n        }\n        tokens.push(`_s(${match[1].trim()})`) // JSON.stringify..\n        lastIndex = index + match[0].length\n      }\n      if(lastIndex < text.length) {\n        tokens.push(JSON.stringify(text.slice(lastIndex)))\n      }\n      return `_v(${tokens.join('+')})`\n    }\n  }\n}\n\nfunction genChildren(el) {\n  let children = el.children\n  if(children) {\n    return children.map(c => gen(c)).join(',')\n  }\n}\n\nfunction genProps(attrs) {\n  let str = ''\n  for(let i = 0; i < attrs.length; i++) {\n    let attr = attrs[i]\n    if(attr.name === 'style') {\n      let styleObj = {}\n      attr.value.replace(/([^;:]+)\\:([^;:]+)/g, function() {\n        styleObj[arguments[1]] = arguments[2]\n      })\n      attr.value = styleObj\n    }\n    str += `${attr.name}:${JSON.stringify(attr.value)},`\n  }\n  return `{${str.slice(0, -1)}}`\n}","import { paeserHTML } from './parse'\nimport { generate } from './generate'\n\nexport function compileToFunction(template) {\n  const root = paeserHTML(template)\n  console.log(root, 'root')\n  const code = generate(root)\n  console.log(code, 'code')\n  const render = new Function(`with(this){return ${code}}`) // code中会用到数据 数据在vm上\n  console.log(render.toString(), '/?')\n  // render.call(vm)\n  return render\n}\n// html => ast(只能描述语法 语法不存在的属性无法描述) => render函数 + （width + new Function）  => 虚拟dom => 生成真实dom\n// TODO with 函数 正则函数..","export function lifecycleMixin(Vue) {\n  Vue.prototype._update = function(vnode) {\n    console.log('update vnode', vnode)\n  }\n}\nexport function mountComponent(vm, el) {\n  console.log(vm, el)\n  // 更新函数 数据变化后 会再次调用此函数\n  let updateComponent = () => {\n    // 调用render函数 生成虚拟dom\n    vm._update(vm._render()) // 后续更新可以调用updateCompoennt方法\n    // 用虚拟dom生成真实dom\n  }\n  updateComponent()\n}","import { initState } from './state'\nimport { compileToFunction } from './compiler/index'\nimport { mountComponent } from './lifecycle'\nexport function initMixin(Vue) { // 表示在vue的基础上做一次混合操作\n  // 默认下划线是私有的\n  Vue.prototype._init = function(options) {\n    console.log(options)\n    const vm = this\n    // vue内部会对属性检测如果是$开头的就不会进行代理\n    vm.$options = options // 后面会对options进行扩展, 这里目前是用户传入的options\n\n    // 对数据进行初始化 watch computed props data\n    initState(vm) // vm 指向当前实例\n\n\n    if(vm.$options.el) {\n      vm.$mount(vm.$options.el)\n    }\n  }\n\n  Vue.prototype.$mount = function(el) {\n    const vm = this\n    const options = vm.$options\n    el = document.querySelector(el)\n\n    if(!options.render) {\n      let template = options.template\n      if(!template && el) {\n        template = el.outerHTML\n        // TODO 生成render函数...\n        // 渲染render...\n        // console.log(template)\n        console.log(template)\n        options.render = compileToFunction(template)\n      }\n    }\n\n    console.log(options.render, 'render...') // 调用render 渲染真实dom 替换掉页面的内容\n    mountComponent(vm, el) // 组件的挂载流程\n  }\n}\n\n\n// 把模板转化成 对应的渲染函数 =》 虚拟dom概念 vnode =》 diff 算法 更新虚拟dom => 产生真实节点，更新\n//  vm.$options render 函数 就不用将模板转为渲染函数了\n// 没有render就用template\n\n// options.render 就是渲染函数","export function createElement(vm, tagName, data = {}, ...children) {\n  // console.log(vm, tagName, data = {}, ...children, 'createElement')\n  return vnode(vm, tagName, data, data.key, children, undefined)\n}\n\nexport function createTextElement(vm ,text) {\n  // console.log(vm, text, 'createTextElement')\n    return vnode(vm, undefined, undefined, undefined, undefined, text)\n}\n\n// export function \n// TODO 虚拟DOM生成完毕...\n// TODO 整理思路!!!!\nfunction vnode(vm, tag, data, key, children, text) {\n  return {\n    vm,\n    tag,\n    data,\n    key,\n    children,\n    text\n    // ...\n  }\n}","import { createElement, createTextElement } from \"./vdom/index\"\n\nexport function renderMixin(Vue) {\n  Vue.prototype._c = function(tagName, attr, ...children) {\n    console.log(tagName, attr, children, '_c')\n    return createElement(this, ...arguments)\n  }\n  Vue.prototype._v = function(text) { // \n    // console.log(text ,'?_v')\n    return createTextElement(this, text)\n  }\n  Vue.prototype._s = function(val) {\n    // return this[val]\n    return JSON.stringify(val)\n  }\n\n  Vue.prototype._render = function() {\n    const vm = this\n    let render = vm.$options.render // 解析出来的render方法\n    // 也有可能是用户写的\n    let vnode = render.call(vm)\n    // TODO _v _c 等方法没有\n    // console.log('render');\n    // 生成虚拟dom\n    return vnode\n  }\n}","import { initMixin } from './init'\nimport { lifecycleMixin } from './lifecycle'\nimport { renderMixin } from './render'\nfunction Vue(options) {\n  // options 为用户传入的选项\n  this._init(options)\n}\n\ninitMixin(Vue)\nrenderMixin(Vue)\nlifecycleMixin(Vue)\n// renderMixin() // _render\n// lifecycleMixin() // _update\n\nexport default Vue"],"names":["isFuntion","data","isObject","val","arrayMethods","Object","create","Array","prototype","oldArrayPrototype","methods","forEach","method","console","log","args","result","call","addList","concat","__ob__","observeArray","Observe","defineProperty","value","enumerable","isArray","__proto__","walk","keys","key","defineReactive","item","observe","get","set","initState","vm","opts","$options","initData","props","_data","proxy","source","newValue","unicodeRegExp","ncname","qnameCapture","attribute","startTagOpen","RegExp","startTagClose","endTag","root","stack","paeserHTML","html","advance","len","substring","parseStartTag","start","match","tagName","attrs","length","end","attr","push","name","createAstElement","tag","type","children","parent","attributes","element","last","pop","Error","chars","text","replace","textEnd","indexOf","startTagMatch","endTagMatch","defaultTagRE","generate","el","genChildren","code","genProps","gen","test","tokens","lastIndex","exec","index","JSON","stringify","slice","trim","join","map","c","str","i","styleObj","arguments","compileToFunction","template","render","Function","toString","lifecycleMixin","Vue","_update","vnode","mountComponent","updateComponent","_render","initMixin","_init","options","$mount","document","querySelector","outerHTML","createElement","undefined","createTextElement","renderMixin","_c","_v","_s"],"mappings":"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"}