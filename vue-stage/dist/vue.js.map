{"version":3,"file":"vue.js","sources":["../src/observer/dep.js","../src/utils.js","../src/observer/array.js","../src/observer/index.js","../src/observer/schedular.js","../src/observer/watcher.js","../src/state.js","../src/compiler/parse.js","../src/compiler/generate.js","../src/compiler/index.js","../src/vdom/patch.js","../src/lifecycle.js","../src/init.js","../src/vdom/index.js","../src/render.js","../src/index.js"],"sourcesContent":["/*\n * @Descripttion: \n * @version: \n * @Author: \n * @Date: 2022-03-16 22:10:33\n * @LastEditors: Please set LastEditors\n * @LastEditTime: 2022-04-08 00:25:20\n */\nlet id = 0;\nexport default class Dep {  // 每个属性都分配一个dep， dep可以存放watcher，watcher还要存放这个dep\n  constructor() {\n    this.id = id++\n    this.subs = [] //用来存放watcher\n  }\n\n  depend() {\n    if(Dep.target) {\n      Dep.target.addDep(this)\n    }\n    // Dep.target dep\n  }\n  addSub(watcher) {\n    // console.log(watcher, 'watcher??');\n    this.subs.push(watcher)\n  }\n  notify() {\n    this.subs.forEach(item => {\n      item.update()\n    })\n  }\n}\nDep.target = null\nconst stack = []\nexport function pushTarget(watcher) {\n  stack.push(watcher)\n  // console.log(Dep.target, 'Dep.target??')\n  Dep.target = watcher\n}\n\nexport function popTarget() {\n  stack.pop()\n  Dep.target = stack[stack.length - 1]\n}\n\n\n// TODO watcher 和 dep 之间的关系...\n// 依赖和watcher之间的关系\n// 依赖和收集依赖\n// 多对多的关系..","/*\n * @Descripttion: \n * @version: \n * @Author: \n * @Date: 2022-03-07 01:13:42\n * @LastEditors: Please set LastEditors\n * @LastEditTime: 2022-04-18 21:53:08\n */\nexport function isFuntion(data) {\n  return typeof data === 'function'\n}\n\nexport function isObject(val) {\n  return typeof val === 'object' && val != null\n}\n\nfunction flushCallBacks() {\n  callbacks.forEach(cb => cb())\n  watting = false\n}\nconst callbacks = []\nlet watting = false\n\nfunction timerFn() {}\n\nif(Promise) {\n  timerFn = () => {\n    Promise.resolve().then(flushCallBacks)\n  }\n} else if (MutationObserver) {\n  let textNode = document.createTextNode(1)\n  let observe = new MutationObserver(flushCallBacks)\n  observe.observe(textNode, {\n    characterData: true\n  })\n\n  timerFn = () => {\n    textNode.textContent = 3\n  }\n  // 微任务\n} else if (setImmediate) {\n  timerFn = () => {\n    setImmediate(flushCallBacks)\n  }\n} else {\n  timerFn = () => {\n    setTimeout(flushCallBacks)\n  }\n}\n\nexport function nextTick(cb) {\n  callbacks.push(cb)\n  if(!watting) {\n    // TODO 这里面到底用啥比较好\n    // vue2 考虑了兼容性问题\n    // vue3 直接用的Promise\n    timerFn()\n    watting = true\n  }\n}\n\nexport function isReservedTab(str) {\n  let strs = 'a,div,span,p,img'\n  return strs.includes(str)\n}\n\n// TODO 异步更新原理 记录nextTick 原理\n\n// TODO 微任务是在页面渲染前执行，但是我取的是内存中的dom，不关心你渲染完毕没有\n// dom树已经更新了...\n// Promise.then\n\n// 明天整理归纳\n// TODO ","export let arrayMethods = Object.create(Array.prototype)\n\nlet oldArrayPrototype = Array.prototype\n\nlet methods = ['push', 'shift', 'pop', 'unshift', 'reverse', 'splice', 'sort']\n\nmethods.forEach(method => {\n  arrayMethods[method] = function(...args) {\n    console.log('数组发生变化...')\n    // TODO 如果是push了一个对象之类的，也需要劫持...\n    const result = oldArrayPrototype[method].call(this, ...args)\n    // 如果有新增，我们要监控的是数组的每一项，而不是数组\n    let addList\n    switch (method) {\n      case 'push': \n      case 'unshift':\n        addList = args\n        break;\n      case 'splice':\n        addList = args.concat(2)\n        break;\n      default:\n    }\n    if(addList) this.__ob__.observeArray(addList)\n    // TODO 梳理关系\n    // 数组的 observer.dep 属性\n    // 为什么数组要有dep \n    // 因为调用方法时 数组更新 需要 调用dep的notify更新数据...\n    // 给数组配置一个dep ,让dep记住这个watcher 数组一旦变化 让这个watcher 更新.\n    this.__ob__.dep.notify()\n\n    return result\n  }\n})","/*\n * @Descripttion: \n * @version: \n * @Author: \n * @Date: 2022-03-07 01:18:16\n * @LastEditors: Please set LastEditors\n * @LastEditTime: 2022-04-08 00:25:49\n */\nimport { isObject } from \"../utils\";\nimport { arrayMethods } from './array'\nimport Dep from \"./dep\";\n\n// 如果数据是对象 会将对象不停地递归 进行劫持\n// 如果是数组， 会劫持数组的方法，并对数组中不是基本数据类型的进行检测\n\n// 如果给对象新增一个属性不会触发视图更新 $set 给对象本身也增加一个watcher 如果增加一个属性后，我就手动的触发watcher的更新\nclass Observe {\n  constructor(data) { // 对对象中的所有属性进行劫持\n    this.dep = new Dep() // 数据可能是数组或者对象\n\n    Object.defineProperty(data, '__ob__', {\n      value: this,\n      enumerable: false\n    })\n    // data.__ob__ = this\n    if(Array.isArray(data)) { // 数组的变化可以触发视图更新\n      // 数组劫持的逻辑\n      // 核心思想是对数组的方法进行劫持\n      // 对数组原来的方法进行改写，切片编程 高阶函数\n      data.__proto__ = arrayMethods\n\n      this.observeArray(data)\n    } else {\n      this.walk(data)\n    }\n  }\n  // 循环遍历劫持...\n  walk(data) { // 对象\n    Object.keys(data).forEach((key) => {\n      defineReactive(data, key, data[key])\n    })\n  }\n\n  observeArray(data) {\n    data.forEach(item => {\n      observe(item)\n    })\n  }\n}\n\nfunction dependArray(value) {\n  value.forEach(item => {\n    item.__ob__&&item.__ob__.dep&&item.__ob__.dep.depend()\n    if(Array.isArray(item)) dependArray(item)\n  })\n}\n\nfunction defineReactive(data, key, value) {\n  const childOb = observe(value)\n  // TODO Object.defineProperties\n  let dep = new Dep() // 每个属性都有一个dep属性\n  Object.defineProperty(data, key, {\n    get() {\n      // 取值时我希望将watcher和dep对应起来\n      // Dep.target\n      console.log(Dep.target, 'Dep.targetDep.targetDep.targetDep.target', key)\n      if(Dep.target) { // 此值是在模板中取值的\n        dep.depend() // 让dep\n\n        if(childOb) { // 可能是对象可能是数组，对象也要收集依赖，$set\n          // 设置值的时候\n          childOb.dep.depend() // 让数组和对象也记录watcher\n          if(Array.isArray(value)) {\n            dependArray(value)\n          }\n        }\n      }\n      return value\n    },\n    set(val) {\n      if(val ===  value) return\n      observe(value) // 如果用户赋值了一个新对象， 需要对这个新对象进行劫持\n      value = val\n      console.log(val)\n      dep.notify() // 通知dep属性更新\n    }\n  })\n}\n\n// import { isObject } from '../utils'\nexport function observe(data) {\n  if(data.__ob__) return data.__ob__\n  // 如果是对象才观测\n  if(!isObject(data)) return\n  // if(!isObject(data)) return\n  return new Observe(data)\n}\n// vue2 没有对数组进行索引的劫持\n// 而且一般用户很少通过索引去操作数组.\n// 内部就想到不对索引进行拦截，因为消耗严重.\n// 数组没有监控索引的变化，但是索引对应的内容是对象类型，需要被监控\n\n// 重写了push shift pop unshift reverse sort splice\n// 这几个方法","/*\n * @Descripttion: \n * @version: \n * @Author: \n * @Date: 2022-03-21 21:34:43\n * @LastEditors: Please set LastEditors\n * @LastEditTime: 2022-04-07 00:30:17\n */\nimport { nextTick } from \"../utils\"\n\nlet queue = []\nlet has = {} // 做列表维护 存放了哪些watcher\nlet pedding = false\nfunction flushSchedulerQueue() {\n  queue.forEach(item => {\n    item.run()\n  })\n  queue = []\n  has = {}\n  pedding = false\n}\n// 同一个watcher\n// 多次dep修改只会执行更新一次\nexport function queueWacther(watcher) { // 当前执行栈中代码执行完毕后，会先清空微任务，再清空宏任务，我希望更早的渲染\n  const id = watcher.id\n  // console.log(watcher, 'watcher')\n  if(!has[id]) {\n    queue.push(watcher)\n    has[id] = true\n  }\n\n  if(!pedding) {\n    // 数据更新完毕之后拿到最新的dom内容\n    // 如果用户不停的写定时器，会开启多个线程\n    nextTick(flushSchedulerQueue, 0)\n    // setTimeout(flushSchedulerQueue, 0)\n    pedding = true\n  }\n}\n\n// 使用setTimeout","import { popTarget, pushTarget } from \"./dep\"\nimport { queueWacther } from \"./schedular\"\n\nlet id = 0\nclass Watcher {\n  constructor(vm, exprOrFn, cb, options) {\n    this.vm = vm\n    this.cb = cb\n    this.options = options\n    this.lazy = options.lazy\n    this.dirty = options.lazy\n    this.id = id++\n    // 默认执行\n    // this.exprOrFn() // 生成render\n    console.log(vm, 'vm')\n    // debugger\n    if(typeof exprOrFn === 'string') {\n      this.getter = function() {\n        console.log(exprOrFn, 'exprOrFn..')\n        const result = exprOrFn.split('.').reduce(function (total, cur) {\n          // console.log(total, this.vm)\n          return total = total[cur]\n        }, this)\n        // debugger\n        return result\n      }\n       \n    } else {\n     this.getter = exprOrFn  \n    }\n    this.deps = []\n    this.depsId = new Set()\n    if(!this.lazy) this.get()\n  }\n  // 用户更新时重新调用getter方法\n  get() {\n    //  defineProperty.get\n    //  每个属性都可以收集自己的watcher\n    // 我希望一个属性可以对应多个watcher 同时一个watcher对应多个属性\n    // console.log(this, 'pushTarget(this)')\n    pushTarget(this)\n    // 每一个组件都有一个watcher 组件渲染之前会建立这个watcher 并且将属性的依赖和该watcher关联起来\n    const value = this.getter.call(this.vm)\n    // console.log(value, value, 'value')\n    popTarget()\n\n    return value\n  }\n  run() {\n    const newVal = this.get()\n    // console.log(this.options.user, 'this.options.user')\n    if(this.options.user) {\n      this.cb.call(this, this.value, newVal)\n      this.value = newVal\n    }\n  }\n  update() {\n    if(this.lazy) {\n      this.dirty = true\n    } else {\n      // 多次调用update 我希望将wathcer缓存下来，等一会一起更新\n      queueWacther(this)\n    }\n  }\n  addDep(dep) {\n    const id = dep.id\n    if(!this.depsId.has(id)) {\n      this.depsId.add(id)\n      this.deps.push(dep)\n      // 如果该watcher没收集过该dep,那么dep也要反向手机watcher\n      dep.addSub(this)\n    }\n  }\n  execute() {\n    this.dirty = false\n    this.value = this.get()\n  }\n\n  depend() {\n    let i = this.deps.length\n    while(i--) {\n      this.deps[i].depend()\n    }\n  }\n}\n\n// 明天抽时间整理\n// watcher 和 dep\n// 我们将更新的功能封装了一个watcher\n// 渲染页面前，会将当前watcher放到Dep类上\n// 在vue中页面渲染时使用的属性，需要进行依赖收集，收集对象的渲染watcher\n// 取值时，给每个属性都加了个dep属性，用于存储这个渲染watcher（同一个watcher会对应多个dep）\n// 每个属性可能对应多个视图（多个视图肯定是多个watcher），一个属性要对应多个watcher\n// dep.depend () => 通知dep存放watcher => Dep.target.addDep() 通知watcher 存放dep\n// 双向存储\n\n// TODO 逻辑过一遍..\n\n// TODO 多次更新只走一次...\n\nexport default Watcher","/*\n * @Descripttion: \n * @version: \n * @Author: \n * @Date: 2022-03-07 01:07:15\n * @LastEditors: Please set LastEditors\n * @LastEditTime: 2022-04-08 00:27:08\n */\nimport Dep from './observer/dep'\nimport { observe } from './observer/index'\nimport Watcher from './observer/watcher'\nimport { isFuntion } from './utils'\n\nexport function stateMixin(Vue) {\n  Vue.prototype.$watch = function(key, handler, options = {}) {\n    options.user = true\n    // console.log(this, key, handler, options, 'this, key, handler, options');\n    new Watcher(this, key, handler, options)\n  }\n}\n\nexport function initState(vm) {\n  const opts = vm.$options\n  if(opts.data) {\n    initData(vm)\n  }\n  if(opts.props) {\n\n  }\n  if(opts.computed) {\n    initComputed(vm, opts.computed)\n  }\n  if(opts.watch) {\n    initWatch(vm, opts.watch)\n  }\n}\n\n\nfunction initData(vm) { // vm\n  let data  = vm.$options.data\n  // 会将data中的所有数据进行数据劫持\n  // defineProperty\n  // 判断类型\n  data = vm._data = isFuntion(data) ? data.call(vm) : data\n\n  for(let key in data) {\n    proxy(vm, '_data', key)\n  }\n  observe(data)\n}\n\n\nfunction proxy(vm, source, key) {\n  Object.defineProperty(vm, key, {\n    get() {\n      return vm[source][key]\n    },\n    set(newValue) {\n      vm[source][key] = newValue\n    }\n  })\n}\n\n\n\n\nfunction initWatch(vm, watch) {\n  for(let key in watch) {\n    const watchItem = watch[key]\n    // 不考虑多配置项.\n    if(Array.isArray(watchItem)) {\n      watchItem.forEach(item => {\n        vm.$watch(key, item)\n      })\n    } else {\n       vm.$watch(key, watchItem)\n    }\n  }\n}\n\nfunction createComputedGetter(key) {\n  return function computedGetter() {\n    let watcher = this._computedGetters[key]\n    if(watcher.dirty) {\n      watcher.execute()\n    }\n\n    // 如果当前取完值后 Dep.target还有值 需要继续向上收集\n    if(Dep.target) {\n      watcher.depend()\n    }\n\n    return watcher.value\n  }\n}\n\n// 属性中的依赖既有渲染watcher 也有 用户自定义的 watcher\nfunction initComputed(vm, computed) {\n  const computedGetters = vm._computedGetters = {}\n  for(let key in computed) {\n    const userDef = computed[key]\n    const getter = typeof userDef === 'function' ? userDef : userDef.get\n\n    computedGetters[key] = new Watcher(vm, getter, () => {}, { lazy: true })\n\n    defineComputed(vm, key, userDef)\n  }\n}\n\nfunction defineComputed(vm, key, userDef) {\n  const propertyConfig = {}\n\n  propertyConfig.get = createComputedGetter(key)\n  propertyConfig.set = typeof userDef === 'function' ? undefined : userDef.set\n\n  Object.defineProperty(vm, key, propertyConfig)\n} \n// 当页面中直接写fullname时， fullname不会去收集渲染wacther fullname 没有dep 没有收集功能。\n// firstName 是在计算属性中使用的，所以他会收集计算属性watcher，没有收集渲染wathcher。\n// 计算属性中的值应该记录计算属性wacther和渲染watcher\n\n\n","const unicodeRegExp = /a-zA-Z\\u00B7\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u203F-\\u2040\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD/\nconst ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z${unicodeRegExp.source}]*` // 标签名\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})` // 用来获取的名的\n// match 后的索引为1的\n\n// Regular Expressions for parsing tags and attributes\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/\n// a=b a=\"b\" a='b'\nconst dynamicArgAttribute = /^\\s*((?:v-[\\w-]+:|@|:|#)\\[[^=]+?\\][^\\s\"'<>\\/=]*)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/\nconst startTagOpen = new RegExp(`^<${qnameCapture}`) // 匹配开始标签\nconst startTagClose = /^\\s*(\\/?)>/ // <div/>\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`) // 匹配闭合标签\nconst doctype = /^<!DOCTYPE [^>]+>/i\nconst defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g\n\n// html字符串解析成dom树 <div id=\"app\"> {{ name }} </div>\n// 将解析后的结果，组装成一个树结构 栈\n// ast 语法层面的描述\n// vdom dom节点\nlet root = null\nlet stack = []\nexport function paeserHTML(html) {\n  function advance(len) {\n    html = html.substring(len)\n  }\n  function parseStartTag() {\n    const start = html.match(startTagOpen)\n    if(start) {\n      const match = {\n        tagName: start[1],\n        attrs: []\n      }\n      advance(start[0].length)\n      // 如果没有遇到皆为标签就不停的解析\n      let end\n      let attr\n      while((!(end = html.match(startTagClose)) && (attr = html.match(attribute)))) {\n        // console.log(attr, 'attr')\n        match.attrs.push({ name: attr[1], value: attr[3] || attr[4] || attr[5] })\n        console.log(attr, '??attr')\n        console.log(html, 'ggg');\n        advance(attr[0].length)\n        console.log(html, '?啦啦啦')\n      }\n      if(end) {\n        console.log(end, 'end')\n        advance(end[0].length)\n        console.log(html, 'end')\n      }\n      return match\n    }\n    return false\n  }\n  function createAstElement(tagName, attrs) {\n    return {\n      tag: tagName,\n      type: 1,\n      children: [],\n      parent: null,\n      attrs\n    }\n  }\n  function start(tagName, attributes) {\n    let parent = stack[stack.length - 1]\n    const element = createAstElement(tagName, attributes)\n    if(!root) {\n      root = element\n    }\n    element.parent = parent // 当放入栈中时，记录父亲是谁\n    if(parent) parent.children.push(element)\n    stack.push(element)\n  }\n  function end(tagName) {\n    // 弹出...\n    let last = stack.pop()\n    console.log(last, tagName, '--------')\n    if(last.tag !== tagName) {\n      throw new Error('标签有误')\n    }\n  }\n  function chars(text) {\n    console.log(text, 'text');\n    console.log(stack, 'stack')\n    text = text.replace(/\\s/g, \"\")\n    const parent = stack[stack.length - 1]\n    // console.log(parent, 'parent')\n    if(text) {\n      parent.children.push({\n        type: 3,\n        text\n      })\n    }\n  }\n  while(html) { // 解析的内容是否存在，如果存在就不停的解析 // htmlParse2\n    let textEnd = html.indexOf('<') // 当前解析的开头\n    if(textEnd === 0) {\n       const startTagMatch = parseStartTag()\n       console.log(startTagMatch, 'startTagMatch')\n       if(startTagMatch) {\n        start(startTagMatch.tagName, startTagMatch.attrs)\n        continue\n       }\n       const endTagMatch = html.match(endTag)\n       console.log(endTagMatch)\n       if(endTagMatch) {\n        end(endTagMatch[1])\n        advance(endTagMatch[0].length)\n        continue\n       }\n    }\n    let text // 1111</div>\n    if(textEnd > 0) {\n      console.log(html, 'html??');\n      text =  html.substring(0, textEnd)\n    }\n    if(text) {\n      chars(text)\n      advance(text.length)\n    }\n  }\n  return root\n}","/*\n * @Descripttion: \n * @version: \n * @Author: \n * @Date: 2022-03-13 11:36:34\n * @LastEditors: \n * @LastEditTime: 2022-03-28 23:44:59\n */\n// TODO 梳理整个思路。。。\n// 看一下用户是否传入了 render \n// 未传入render ，没传入可能传入的是template，如果template也没有传递\n// 将html进行词法解析（开始标签，结束标签 属性 文本）\n// ast 语法树  用来描述html语法的stack = []\n// codegen   <div>hello</div> => _c('div',{},'hello') 让字符串执行\n// eval 耗性能 会有作用域问题\n\n// 模板引擎 new Function\nconst defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g\n\nexport function generate(el) {\n  console.log(el)\n  // 遍历树 将树拼接成字符串\n  let children = genChildren(el)\n  let code = `_c(\"${ el.tag }\",${el.attrs.length ? genProps(el.attrs) : 'undefined'}${ children ? `,${children}`  : '' })`\n\n  return code\n}\n\nfunction gen (el) {\n  if(el.type === 1) return generate(el)\n  // console.log(el, 'el??');\n  if(el.type === 3) {\n    let text = el.text\n    if(!defaultTagRE.test(text)) {\n      return `_v('${text}')`\n    } else {\n      // hello{{arr}}world => 'hello' + arr + 'world'\n      let tokens = []\n      let match\n      let lastIndex = defaultTagRE.lastIndex = 0\n      // console.log(text, 'text')\n      // console.log(defaultTagRE.exec(text))\n      \n      while(match = defaultTagRE.exec(text)) {\n        let index = match.index // 开始索引\n        // console.log(index, 'lastIndex')\n        if(index > lastIndex) {\n          console.log(match, 'match')\n          tokens.push(JSON.stringify(text.slice(lastIndex, index)))\n        }\n        tokens.push(`_s(${match[1].trim()})`) // JSON.stringify..\n        lastIndex = index + match[0].length\n      }\n      if(lastIndex < text.length) {\n        tokens.push(JSON.stringify(text.slice(lastIndex)))\n      }\n      return `_v(${tokens.join('+')})`\n    }\n  }\n}\n\nfunction genChildren(el) {\n  let children = el.children\n  if(children) {\n    return children.map(c => gen(c)).join(',')\n  }\n}\n\nfunction genProps(attrs) {\n  let str = ''\n  for(let i = 0; i < attrs.length; i++) {\n    let attr = attrs[i]\n    if(attr.name === 'style') {\n      let styleObj = {}\n      attr.value.replace(/([^;:]+)\\:([^;:]+)/g, function() {\n        styleObj[arguments[1]] = arguments[2]\n      })\n      attr.value = styleObj\n    }\n    str += `${attr.name}:${JSON.stringify(attr.value)},`\n  }\n  return `{${str.slice(0, -1)}}`\n}","import { paeserHTML } from './parse'\nimport { generate } from './generate'\n\nexport function compileToFunction(template) {\n  const root = paeserHTML(template)\n  console.log(root, 'root')\n  const code = generate(root)\n  console.log(code, 'code')\n  const render = new Function(`with(this){return ${code}}`) // code中会用到数据 数据在vm上\n  console.log(render.toString(), '/?')\n  // render.call(vm)\n  return render\n}\n// html => ast(只能描述语法 语法不存在的属性无法描述) => render函数 + （width + new Function）  => 虚拟dom => 生成真实dom\n// TODO with 函数 正则函数..","export function patch(oldVnode, vnode) {\n  if(oldVnode.nodeType == 1) {\n    // 真实元素\n    // 用vnode 来生成真实dom替换成原本的dom元素\n    // 删除原来的节点 然后用虚拟节点生成的dom放置到老节点的下一个节点\n    const parentElm = oldVnode.parentNode\n\n    const elm = createEle(vnode)\n    // 在第一次渲染后 删除掉节点， 下次无法获取\n    parentElm.insertBefore(elm, oldVnode.nextSibling)\n\n    parentElm.removeChild(oldVnode)\n\n    return elm\n  }\n}\n\nfunction createEle(vnode) {\n  let { tag, data, children, text, vm } = vnode\n  if(typeof vnode.tag === 'string') {\n    vnode.el = document.createElement(tag) // 虚拟节点会有一个el属性对应真实节点\n\n    children.forEach(child => {\n      vnode.el.appendChild(createEle(child))\n    })\n  } else {\n    vnode.el = document.createTextNode(text)\n  }\n  return vnode.el\n}","import Watcher from \"./observer/watcher\"\nimport { nextTick } from \"./utils\"\nimport { patch } from \"./vdom/patch\"\n\nexport function lifecycleMixin(Vue) {\n  Vue.prototype._update = function(vnode) {\n    console.log('update vnode-----', vnode)\n    // 初始化 更新\n    // 既有初始化 又有更新 比较前后差异\n    const vm = this\n    vm.$el = patch(vm.$el, vnode)\n    // 更新不需要重新的词法分析，只需要重新调用render\n    // 不管怎么样初始的html是固定的\n    // 将虚拟dom生成真实dom\n  }\n}\n\n// 后续每个组件渲染的时候都有一个watcher\nexport function mountComponent(vm, el) {\n  // 更新函数 数据变化后 会再次调用此函数\n  let updateComponent = () => {\n    // 调用render函数 生成虚拟dom\n    vm._update(vm._render()) // 后续更新可以调用updateCompoennt方法\n    // 用虚拟dom生成真实dom\n    // 重新调用render方法产生虚拟dom 目前还没有diff\n  }\n  vm.$nextTick = nextTick\n  // 观察者模式 属性是被观察者  属性页面：观察者\n  new Watcher(vm, updateComponent, () => {\n    console.log('更新视图了')\n  }, true) // 它是一个渲染watcher 后续有其他的watcher\n}","import { initState } from './state'\nimport { compileToFunction } from './compiler/index'\nimport { mountComponent } from './lifecycle'\nexport function initMixin(Vue) { // 表示在vue的基础上做一次混合操作\n  // 默认下划线是私有的\n  Vue.prototype._init = function(options) {\n    console.log(options)\n    const vm = this\n    // vue内部会对属性检测如果是$开头的就不会进行代理\n    vm.$options = options // 后面会对options进行扩展, 这里目前是用户传入的options\n\n    // 对数据进行初始化 watch computed props data\n    initState(vm) // vm 指向当前实例\n\n\n    if(vm.$options.el) {\n      vm.$mount(vm.$options.el)\n    }\n  }\n\n  Vue.prototype.$mount = function(el) {\n    const vm = this\n    const options = vm.$options\n    el = document.querySelector(el)\n    vm.$el = el\n\n    if(!options.render) {\n      let template = options.template\n      if(!template && el) {\n        template = el.outerHTML\n        // TODO 生成render函数...\n        // 渲染render...\n        // console.log(template)\n        console.log(template)\n        options.render = compileToFunction(template)\n      }\n    }\n\n    console.log(options.render, 'render...') // 调用render 渲染真实dom 替换掉页面的内容\n    mountComponent(vm, el) // 组件的挂载流程\n  }\n}\n\n\n// 把模板转化成 对应的渲染函数 =》 虚拟dom概念 vnode =》 diff 算法 更新虚拟dom => 产生真实节点，更新\n//  vm.$options render 函数 就不用将模板转为渲染函数了\n// 没有render就用template\n\n// options.render 就是渲染函数","import { isReservedTab } from \"../utils\"\n\nexport function createElement(vm, tagName, data = {}, ...children) {\n  // console.log(vm, tagName, data = {}, ...children, 'createElement')\n  console.log(tagName, 'tagName')\n\n  // 如果tag是一个组件 应该渲染一个组件的vnode\n\n  if(isReservedTab(tag)) {\n    return vnode(vm, tagName, data, data.key, children, undefined)\n  } else {\n    // vm.$options.components\n    // return cr\n  }\n\n\n}\n\nexport function createTextElement(vm ,text) {\n  // console.log(vm, text, 'createTextElement')\n    return vnode(vm, undefined, undefined, undefined, undefined, text)\n}\n\n// export function \n// TODO 虚拟DOM生成完毕...\n// TODO 整理思路!!!!\nfunction vnode(vm, tag, data, key, children, text) {\n  return {\n    vm,\n    tag,\n    data,\n    key,\n    children,\n    text\n    // ...\n  }\n}","import { createElement, createTextElement } from \"./vdom/index\"\n\nexport function renderMixin(Vue) {\n  Vue.prototype._c = function(tagName, attr, ...children) {\n    console.log(tagName, attr, children, '_c')\n    return createElement(this, ...arguments)\n  }\n  Vue.prototype._v = function(text) { // \n    // console.log(text ,'?_v')\n    return createTextElement(this, text)\n  }\n  Vue.prototype._s = function(val) {\n    // return this[val]\n    if(typeof val === 'object') return JSON.stringify(val)\n    return val\n  }\n\n  Vue.prototype._render = function() {\n    const vm = this\n    let render = vm.$options.render // 解析出来的render方法\n    // 也有可能是用户写的\n    let vnode = render.call(vm)\n    // TODO _v _c 等方法没有\n    // console.log('render');\n    // 生成虚拟dom\n    return vnode\n  }\n}","import { initMixin } from './init'\nimport { lifecycleMixin } from './lifecycle'\nimport { renderMixin } from './render'\nimport { stateMixin } from './state'\nfunction Vue(options) {\n  // options 为用户传入的选项\n  this._init(options)\n}\n\ninitMixin(Vue)\nrenderMixin(Vue)\nlifecycleMixin(Vue)\nstateMixin(Vue)\n// renderMixin() // _render\n// lifecycleMixin() // _update\n\nexport default Vue"],"names":["id","Dep","subs","target","addDep","watcher","push","forEach","item","update","stack","pushTarget","popTarget","pop","length","isFuntion","data","isObject","val","flushCallBacks","callbacks","cb","watting","timerFn","Promise","resolve","then","MutationObserver","textNode","document","createTextNode","observe","characterData","textContent","setImmediate","setTimeout","nextTick","isReservedTab","str","strs","includes","arrayMethods","Object","create","Array","prototype","oldArrayPrototype","methods","method","console","log","args","result","call","addList","concat","__ob__","observeArray","dep","notify","Observe","defineProperty","value","enumerable","isArray","__proto__","walk","keys","key","defineReactive","dependArray","depend","childOb","get","set","queue","has","pedding","flushSchedulerQueue","run","queueWacther","Watcher","vm","exprOrFn","options","lazy","dirty","getter","split","reduce","total","cur","deps","depsId","Set","newVal","user","add","addSub","i","stateMixin","Vue","$watch","handler","initState","opts","$options","initData","props","computed","initComputed","watch","initWatch","_data","proxy","source","newValue","watchItem","createComputedGetter","computedGetter","_computedGetters","execute","computedGetters","userDef","defineComputed","propertyConfig","undefined","unicodeRegExp","ncname","qnameCapture","attribute","startTagOpen","RegExp","startTagClose","endTag","root","paeserHTML","html","advance","len","substring","parseStartTag","start","match","tagName","attrs","end","attr","name","createAstElement","tag","type","children","parent","attributes","element","last","Error","chars","text","replace","textEnd","indexOf","startTagMatch","endTagMatch","defaultTagRE","generate","el","genChildren","code","genProps","gen","test","tokens","lastIndex","exec","index","JSON","stringify","slice","trim","join","map","c","styleObj","arguments","compileToFunction","template","render","Function","toString","patch","oldVnode","vnode","nodeType","parentElm","parentNode","elm","createEle","insertBefore","nextSibling","removeChild","createElement","child","appendChild","lifecycleMixin","_update","$el","mountComponent","updateComponent","_render","$nextTick","initMixin","_init","$mount","querySelector","outerHTML","createTextElement","renderMixin","_c","_v","_s"],"mappings":"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"}